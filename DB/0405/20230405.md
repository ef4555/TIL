# 데이터베이스

- 개인은 파일을 통해 데이터를 저장

  - 성능과 보안 측면에서 한계가 명확
  - 대용량 데이터를 다루기에 적합하지 않음
  - 데이터를 구조적으로 정리하기 어려움
  - 확장이 불가능

- 관계형 데이터베이스
- NoSQL 데이터베이스
  - 관계형 데이터베이스의 한계를 극복하기 위해 좀 더 유연한 데이터베이스
  - 실제로 많이 쓰이는 데이터베이스로, 서브 데이터베이스로 두고 빠른 처리, 확장이 필요한 기능에서 사용하는 경우가 많음
  - 일반적으로 메인 테이터베이스는 관계형 데이터베이스를 사용

## 관계형 데이터베이스

- 데이터를 테이블, 행, 열 등으로 나누어 구조화
- 구조화해서 저장하므로 보다 체계적으로 데이터를 저장하고 관리할 수 있음
- 자료를 여러 테이블로 나누어서 관리하고 테이블간 관꼐를 설정해 여러 데이터를 조작할 수 있음
- 데이터의 무결성(정확성, 일관성) 유지에 장점이 있음
- SQL을 사용하여 데이터를 조회하고 조작

### 관계형 데이터베이스의 구조

1. 스키마

- 테이블의 구조(청사진), 데이터베이스에서 자료의 구조, 표현 장법, 관계 등 전반적인 명세를 기술한 것

2. 테이블 : 필드와 레코드를 사용해 조직된 데이터 요소들의 집합
1. 필드 : 속성, 컬럼

   - 각 필드에는 고유한 데이터 형식(타입)이 저장됨

1. 레코드 : 튜플, 행

   - 테이블의 데이터는 레코드에 저장됨

1. PK(Primary key)

   - 기본 키
   - 각 레코드의 고유한 값
     - 각각의 데이터를 구분 할 수 잇는 고유값
   - 기술적으로 다른 항목과 절대적으로 중복될 수 없는 단일 값
   - 데이터베이스 관리 및 테이블 간 관계 설정시 주요하게 활용

1. FK(Foreign Key)

   - 외래 키
   - 한 테이블의 속성 중 다른 테이블의 레코드를 식별할 수 있는 ㅣ
   - 다른 테이블의 기본 키를 참조
   - 참조하는 테이블의 속성 1개의 값은, 참조되는 측 테이블의 레코드 값에 대응됨
   - 각 레코드에서 서로 다른 테이블 간의 관계를 만드는 데 사용할 수 있음

- 용어 정리

  1. table(Relation)
  2. Field(Column, Attribute)
  3. Record(Row, Tuple)
  4. Schema
  5. Primary Key
  6. Foreign Key

- DBMS : 데이터베이스를 쉽게 조작할 수 있게 해주는 소프트웨어

## SQL Commands

- DDL
  - 데이터 정의 언어
  - 관계형 데이터베이스 구조(테이블, 스키마)를 정의(생성, 수정, 삭제)하기 위한 명령어
  - create, drop, alter
- DML
  - 데이터 조작 언어
  - 데이터를 조작(추가, 조회, 변경, 삭제)
  - INSERT, SELECT, UPDATE, DELETE

'''
SELECT column_name FROM table_name;
'''

- 모든 SQL문은 SELECT, INSERT, UPDATE 등과 같은 키워드로 시작하고 하나의 statement는 세미콜론으로 끝남

## SQLite data types

1. NULL
   1. NULL value
   2. 정보가 없거나 알 수 없음을 의미
2. INTEGER
   1. 정수
   2. 크기에 따라 0, 1, 2, 3, 4, 6 또는 8바이트와 같은 가변 크기를 가짐
3. REAL
   1. 실수
   2. 8바이트 부동 소수점을 사용하는 10진수 값이 있는 실수
4. TEXT
   1. 문자 데이터
5. BLOB(Binary Large Object)
   1. 입력된 그대로 저장된 데이터 덩어리(대용 타입 없음)
   2. 바이너리 등 멀티미디어 파일

- SQLite에는 별도의 Boolean 타입이 없음
- 대신 Boolean 값은 정수 0(False)과 1(True)로 저장됨

- SQLite에는 날짜 및 시간을 저장하기 위한 타입이 없음
- 대신 SQLite의 built-in "Date and Time Functions"으로 TEXT, REAL, INTEGER 값으로 저장할 수 있음

- Binary Data

  - 데이터 저장과 처리를 목적으로 0과 1의 이진 형식으로 인코딩 된 파일
  - 기본적으로 컴퓨터의 모든 데이터는 binary data
    - 다만 이를 필요에 따라서 텍스트 타입으로 변형하여 사용하는 것

- Type Affinity
  - 타입 선호도
  - 특정 칼럼에 저장된 데이터에 권장되는 타입
  - 데이터 타입 장성 시 SQLite의 5가지 데이터 타입이 아닌 다른 데이터 타입을 선언한다면 내부적으로 각 타입의 지정된 선호도에 따라 5가지 선호도로 인식됨
    1. INTEGER
    2. TEXT
    3. BLOB
    4. REAL
    5. NUMERIC
  - 다른 데이터베이스 엔진 간의 호환성을 최대화
  - 정적이고 엄격한 타입을 사용하는 데이터베이스 SQL문을 SQLite에서도 작동하도록 하기 위함

## constraints

- 제약 조건

  - 입력하는 자료에 대해 제약을 정함
  - 제약에 맞지 않다면 입력이 거부됨
  - 사용자가 원하는 조건의 데이터만 유지하기 위한, 즉, 데이터의 무결성을 유지하기 위한 보편적인 방법으로 테이블의 특정 칼럼에 설정하는 제약

- 데이터 무결성

  - 데이터 베이스 내의 데이터에 대한 정확성, 일관성을 보장하기 위한 데이터 변경 혹은 수정 시 여러 제한을 두어 데이터의 정확성을 보장하는 것
    - 무결성이란 데이터의 정확성, 일관성을 나타냄
  - 데이터베이스에 저장된 데이터의 무결성을 보장하고 데이터베이스의 상태를 일관되게 유지하는 것이 목적

- constraints 종류
  1. NOT NULL
     1. 컬럼이 NULL값을 허용하지 않도록 지정
     2. 기본적으로 테이블의 모든 컬럼은 NOT NULL 제약 조건을 명시적으로 사용하는 경우를 제외하고는 NULL값을 허용함
  2. UNIQUE
     1. 칼럼의 모든 값이 서로 구별되거나 고유한 값이 되도록 함
  3. PRIMARY KEY
     1. 테이블에서 행의 고유성을 식별하는데 사용되는 칼럼
     2. 각 테이블에는 하나의 기본 키만 있음
     3. 암시적으로 NOT NULL 제약 조건이 포함되어 있음
  4. AUTOINCREMENT
     1. 사용되지 않은 값이나 이전에 삭제된 행의 값을 재사용하는 것을 방지
     2. INTEGER PRIMARY KEY 다음에 작성하면 해당 rowid를 다시 재사용하지 못하도록 함
     3. 장고에서 테이블 생성 시 id 칼럼에 기본적으로 사용하는 제약 조건
  5. 기타 Constaints

### rowid 특징

- 테이블을 생성할 때마다 rowid라는 암시적 자동 증가 컬럼이 자동으로 생성됨
- 테이블의 행을 고유하게 식별하는 64비트 부호 있는 정수 값
- 테이블에 새 행을 삽입할 때마다 정수 값을 자동으로 할당
  - 값은 1부터 시작
  - 데이터 삽입 시에 rowid 또는 INTEGER PRIMARY KEY 컬럼에 명시적ㅇ로 값이 지정되지 않은 경우 SQLite는 테이블에서 가장 큰 rowid 보다 하나 큰 다음 순차 정수를 자동으로 할당 (AUTOINCREMENT와 관계없이)
- INTEGER PRIMARY KEY 키워드를 가진 칼럼을 직접 만들면 이 칼럼은 rowid 칼럼의 별칭이 됨
  - 새 컬럼 이름으로 rowid에 엑세스 할 수 있으며 rowid 이름으로도 여전히 엑세스 가능
- 데이터가 최대 값에 도달하고 새 행을 삽입하려고 하면 SQLite는 사용하지 않는 정수를 찾아 사용
- 만약 SQLite가 사용되지 않은 정수를 찾을 수 없으면 SQLite_FUll에러가 발생
  - 또한 일부 행을 삭제하고 새 행을 삽입하려면 SQLite눈 삭제된 행에서 rowid 값을 재사용하려고 시도

## ALTER TABLE

- 기존 테이블의 구조를 수정(변경)
- SQLite의 ALTER TABLE 문을 사용하면 기존 테이블을 다음과 같이 변경 가능

  1. Rename a table
  2. Rename a colunm
  3. ADD a new column to a table
  4. Delete a column

- DDL 정리
  - 데이터 정의 언어
  - CREATE TABLE
    - 데이터 타입과 제약조건
  - ALTER TABLE
    - RENAME
    - RENAME COLUMN
    - ADD COLUMN
    - DROP COLUMN
  - DROP TABLE

## DML

- 데이터 조작
  - INSERT, SELECT, UPDATE, DELETE
- SQLite는 NULL 값을 중복으로 간주
- NULL 값이 있는 컬럼에 DISTINCT 절을 사용하면 SQLite는 NULL 값의 한 행을 유지

### 논리연산자

- 일부 표현식의 참 거짓을 테스트 가능
- 1,0또는 NULL값을 반환
- SQLite는 Boolean 데이터 타입을 제공하지 않으므로 1은 참 0은 거짓 의미

### WHERE

- 조회 시 특정 검색 조건을 지정
- SELECT 문에서 선택적으로 사용할 수 있는 절
  - 이외에도 UPDATE, DELETE 문에서 사용 가능
  - FROM 절 뒤에 작성

### LIKE

- 패턴 일치를 기반으로 데이터 조회
- SELECT, UPDATE, DELETE문의 WHERE 절에서 사용
- 기본적으로 대소문자를 구분하지 않는다

  - 'A' LIKE 'a'는 참이다

- SQLite는 패턴 구성을 위한 두 개의 와일드카드 제공
  - %
    - 0개 이상의 문자가 올 수 있음을 의미
  - \_
    - 단일 문자가 있음을 의미

### IN

- 값이 값 목록 결과에 있는 값과 일치하는지 확인
- IN의 결과를 부정하려면 NOT IN 사용

### BETWEEN

- 값이 범위에 있는지 테스트
- 값이 지정된 범위에 있으면 True를 반환
- SELECT, UPDATE, DELETE문의 WHERE 절에서 사용
- 반대로는 NOT BETEEN

### LIMIT

- 쿼리에서 반환되는 행 수를 제한
- SELECT 문에서 선택적으로 사용할 수 있는 절
- row-count는 반환되는 행 수를 지정하는 양의 정수를 의미
  